import{A as Vt,B as $t,C as Ht,F as qt,I as Gt,J as Yt,L as Qt,M as Q,N as W,O as Wt,P as Jt,T as Kt,U as Xt,V as Zt,W as te,X as ee,Z as ae,_ as ie,ia as ne,ja as oe,ma as re,p as kt,q as Tt,r as zt,s as Ft,t as Lt,u as At,v as Nt,w as jt,x as Bt,y as Rt,z as Ut,za as ce}from"./chunk-YJA7LBCE.js";import{$a as $,Bd as se,Ea as g,F as U,Fa as i,Ga as n,Ha as f,J as lt,K as gt,Kb as vt,La as N,Lb as T,M as mt,Ma as j,Nb as ht,Oa as S,P as h,Q as b,Qa as d,Ra as p,Tb as bt,Va as tt,Wa as et,Xa as at,_ as V,_b as xt,a as M,ab as H,ac as w,b as A,bb as k,db as o,dc as yt,ea as c,eb as C,ec as Mt,fb as _,gb as pt,h as ct,hb as ut,ia as P,ib as Ct,ic as Pt,jb as ft,lc as Ot,ma as O,mb as _t,md as z,n as v,na as dt,oc as St,pb as q,qa as m,qb as G,rc as wt,rd as F,sa as D,sc as Et,tc as It,td as E,ub as Y,vc as Dt,vd as L,ya as Z}from"./chunk-JUX2TMYD.js";var I=class r{constructor(t){this.appStateService=t}getCategorias(){return this.appStateService.categories$}getCategoriaById(t){return this.getCategorias().pipe(v(e=>e.find(a=>a.id===t)))}addCategoria(t){this.appStateService.addCategory(t)}updateCategoria(t,e){this.getCategoriaById(t).subscribe(a=>{a&&this.appStateService.updateCategory(M(M({},a),e))})}deleteCategoria(t){this.appStateService.deleteCategory(t)}getCategoriasGastos(){return this.getCategorias()}getActiveCategorias(){return this.getCategorias().pipe(v(t=>t.filter(e=>e.activa)))}getInactiveCategorias(){return this.getCategorias().pipe(v(t=>t.filter(e=>!e.activa)))}getCategoriasByParent(t){return this.getCategorias().pipe(v(e=>e.filter(a=>a.categoriaParentId===t)))}getMainCategorias(){return this.getCategoriasByParent(null)}getSubcategorias(t){return this.getCategoriasByParent(t)}getCategoriaHierarchy(){return this.getCategorias().pipe(v(t=>{let e=new Map,a=[];return t.forEach(s=>{e.set(s.id,A(M({},s),{subcategorias:[]}))}),t.forEach(s=>{let l=e.get(s.id);if(s.categoriaParentId){let y=e.get(s.categoriaParentId);y&&y.subcategorias.push(l)}else a.push(l)}),a}))}searchCategorias(t){return this.getCategorias().pipe(v(e=>{let a=t.toLowerCase().trim();return a?e.filter(s=>s.nombre.toLowerCase().includes(a)||s.descripcion?.toLowerCase().includes(a)||s.icono?.toLowerCase().includes(a)):e}))}getCategoriasByColor(t){return this.getCategorias().pipe(v(e=>e.filter(a=>a.color===t)))}getCategoriasByIcon(t){return this.getCategorias().pipe(v(e=>e.filter(a=>a.icono===t)))}getCategoriasStatistics(){return this.getCategorias().pipe(v(t=>{let e=t,a=t.filter(x=>x.activa),s=t.filter(x=>!x.activa),l=t.filter(x=>!x.categoriaParentId),y=t.filter(x=>x.categoriaParentId);return{total:t.length,gastos:e.length,activas:a.length,inactivas:s.length,principales:l.length,subcategorias:y.length}}))}validateCategoria(t){let e=[];return t.nombre?.trim()||e.push("El nombre es requerido"),t.tipo||e.push("El tipo es requerido"),t.tipo&&t.tipo!=="gasto"&&e.push('El tipo debe ser "gasto"'),t.color?.trim()||e.push("El color es requerido"),t.color&&!/^#[0-9A-F]{6}$/i.test(t.color)&&e.push("El color debe ser un c\xF3digo hexadecimal v\xE1lido"),e}isValidCategoria(t){return this.validateCategoria(t).length===0}duplicateCategoria(t){this.getCategoriaById(t).subscribe(e=>{if(e){let a=A(M({},e),{id:Date.now().toString(),nombre:`${e.nombre} (Copia)`,fechaCreacion:new Date().toISOString().split("T")[0]});this.addCategoria(a)}})}toggleCategoriaStatus(t){this.getCategoriaById(t).subscribe(e=>{e&&this.updateCategoria(t,{activa:!e.activa})})}moveCategoria(t,e){this.updateCategoria(t,{categoriaParentId:e||void 0})}getAvailableColors(){return["var(--mat-sys-error)","var(--mat-sys-tertiary)","var(--mat-sys-primary)","var(--mat-sys-success)","var(--mat-sys-warning)","var(--mat-sys-secondary)","var(--mat-sys-info)","var(--mat-sys-warning-container)","var(--mat-sys-secondary-container)","var(--mat-sys-primary-container)","var(--mat-sys-tertiary-container)","var(--mat-sys-success-container)","var(--mat-sys-error-container)","var(--mat-sys-outline)","var(--mat-sys-surface-variant)"]}getAvailableIcons(){return["home","directions_car","shopping_cart","restaurant","sports_esports","favorite","book","work","credit_card","card_giftcard","flight","local_cafe","smartphone","laptop","headphones","camera_alt","directions_bike","fitness_center","local_pharmacy","school","child_care","pets","park","local_gas_station","build","palette","music_note","movie","checkroom","content_cut","attach_money","savings","account_balance","trending_up","trending_down","category","folder","star","lightbulb","eco"]}exportCategorias(){return this.getCategorias().pipe(v(t=>JSON.stringify(t,null,2)))}importCategorias(t){try{let e=JSON.parse(t);return e.every(s=>this.isValidCategoria(s))?(e.forEach(s=>{let l=A(M({},s),{id:Date.now().toString()+Math.random().toString(36).substr(2,9),fechaCreacion:new Date().toISOString().split("T")[0]});this.addCategoria(l)}),!0):!1}catch(e){return console.error("Error importing categories:",e),!1}}getAll(){return this.getCategorias()}add(t){let e=A(M({},t),{id:Date.now().toString(),fechaCreacion:new Date().toISOString().split("T")[0]});return this.addCategoria(e),Promise.resolve(e)}update(t,e){return this.updateCategoria(t,e),this.getCategoriaById(t).pipe(v(a=>a)).toPromise()}static \u0275fac=function(e){return new(e||r)(mt(ce))};static \u0275prov=lt({token:r,factory:r.\u0275fac,providedIn:"root"})};function ue(r,t){r&1&&(i(0,"mat-error"),o(1,"El nombre es obligatorio."),n())}function Ce(r,t){if(r&1&&(i(0,"mat-option",17),o(1),n()),r&2){let e=t.$implicit;g("value",e.id),c(),_(" ",e.nombre," ")}}function fe(r,t){r&1&&(i(0,"mat-icon",34),o(1,"check"),n())}function _e(r,t){if(r&1){let e=S();i(0,"button",32),d("click",function(){let s=h(e).$implicit,l=p();return b(l.selectColor(s))}),m(1,fe,2,0,"mat-icon",33),n()}if(r&2){let e,a,s=t.$implicit,l=p();H("background-color",s),k("selected",((e=l.categoriaForm.get("color"))==null?null:e.value)===s),Z("aria-label","Seleccionar color "+s),c(),g("ngIf",((a=l.categoriaForm.get("color"))==null?null:a.value)===s)}}function ve(r,t){r&1&&(i(0,"mat-error"),o(1,"Debes seleccionar un color."),n())}function he(r,t){if(r&1){let e=S();i(0,"button",35),d("click",function(){let s=h(e).$implicit,l=p();return b(l.selectIcon(s))}),i(1,"mat-icon"),o(2),n()()}if(r&2){let e,a=t.$implicit,s=p();k("selected",((e=s.categoriaForm.get("icono"))==null?null:e.value)===a),Z("aria-label","Seleccionar icono "+s.getIconLabel(a)),c(2),C(a)}}function be(r,t){r&1&&(i(0,"mat-error"),o(1,"Debes seleccionar un icono."),n())}function xe(r,t){r&1&&f(0,"mat-spinner",36)}function ye(r,t){if(r&1&&(i(0,"span"),o(1),n()),r&2){let e=p();c(),C(e.getSaveLabel())}}var R=class r{constructor(t,e,a,s){this.fb=t;this.categoriasService=e;this.dialogRef=a;this.data=s;this.categoriaForm=this.createForm()}categoriaForm;saving=!1;availableColors=[];availableIcons=[];availableParentCategories=[];ngOnInit(){this.loadAvailableOptions(),this.loadAvailableParentCategories(),this.data.categoria&&this.populateForm()}createForm(){return this.fb.group({nombre:["",[w.required,w.minLength(2),w.maxLength(50)]],descripcion:["",[w.maxLength(200)]],tipo:["gasto",[w.required]],color:["",[w.required]],icono:["",[w.required]],categoriaParentId:[null],activa:[!0]})}loadAvailableOptions(){this.availableColors=this.categoriasService.getAvailableColors(),this.availableIcons=this.categoriasService.getAvailableIcons()}loadAvailableParentCategories(){this.categoriasService.getCategorias().subscribe(t=>{this.availableParentCategories=t.filter(e=>!e.categoriaParentId)})}populateForm(){if(!this.data.categoria)return;let{categoria:t,mode:e}=this.data;this.categoriaForm.patchValue({nombre:e==="duplicate"?`${t.nombre} (Copia)`:t.nombre,descripcion:t.descripcion||"",tipo:t.tipo,color:t.color,icono:t.icono,categoriaParentId:t.categoriaParentId||null,activa:t.activa})}selectColor(t){this.categoriaForm.patchValue({color:t})}selectIcon(t){this.categoriaForm.patchValue({icono:t})}onSave(){if(this.categoriaForm.invalid){this.categoriaForm.markAllAsTouched();return}this.saving=!0;let t=M({},this.categoriaForm.value);this.data.mode==="edit"&&this.data.categoria&&(t.id=this.data.categoria.id),this.dialogRef.close(t)}getDialogTitle(){switch(this.data.mode){case"create":return"Nueva Categor\xEDa";case"edit":return"Editar Categor\xEDa";case"duplicate":return"Duplicar Categor\xEDa"}}getSaveLabel(){return this.data.mode==="edit"?"Guardar Cambios":"Crear Categor\xEDa"}hasError(t,e){let a=this.categoriaForm.get(t);return!!(a?.hasError(e)&&(a?.dirty||a?.touched))}getSelectedParentCategoria(){let t=this.categoriaForm.get("categoriaParentId")?.value;return this.availableParentCategories.find(e=>e.id===t)}getIconLabel(t){return t.replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase())}static \u0275fac=function(e){return new(e||r)(P(It),P(I),P(Kt),P(Xt))};static \u0275cmp=O({type:r,selectors:[["app-categoria-dialog"]],standalone:!1,decls:71,vars:14,consts:[[1,"unified-modal"],[1,"modal-header"],[1,"header-content"],[1,"header-icon"],[1,"header-title"],["mat-icon-button","","mat-dialog-close","",1,"close-button"],[1,"modal-content"],[3,"keydown.enter","formGroup"],[1,"form-section"],[1,"form-row"],[1,"full-width"],["matInput","","formControlName","nombre","required","","maxlength","50"],["align","end"],[4,"ngIf"],["matInput","","formControlName","descripcion","rows","2","maxlength","200"],["type","hidden","formControlName","tipo","value","gasto"],["formControlName","categoriaParentId"],[3,"value"],[3,"value",4,"ngFor","ngForOf"],[1,"color-selection"],[1,"selection-label"],[1,"color-grid"],["type","button","class","color-option",3,"selected","background-color","click",4,"ngFor","ngForOf"],[1,"icon-selection"],[1,"icon-grid"],["type","button","class","icon-option",3,"selected","click",4,"ngFor","ngForOf"],[1,"checkbox-container"],["formControlName","activa"],[1,"modal-actions"],["mat-stroked-button","","mat-dialog-close",""],["mat-raised-button","","color","primary",3,"click","disabled"],["diameter","20",4,"ngIf"],["type","button",1,"color-option",3,"click"],["class","check-icon",4,"ngIf"],[1,"check-icon"],["type","button",1,"icon-option",3,"click"],["diameter","20"]],template:function(e,a){if(e&1&&(i(0,"div",0)(1,"div",1)(2,"div",2)(3,"mat-icon",3),o(4,"category"),n(),i(5,"h2",4),o(6),n()(),i(7,"button",5)(8,"mat-icon"),o(9,"close"),n()()(),i(10,"div",6)(11,"form",7),d("keydown.enter",function(){return a.onSave()}),i(12,"div",8)(13,"h3"),o(14,"Informaci\xF3n B\xE1sica"),n(),i(15,"div",9)(16,"mat-form-field",10)(17,"mat-label"),o(18,"Nombre"),n(),f(19,"input",11),i(20,"mat-hint",12),o(21),n(),m(22,ue,2,0,"mat-error",13),n()(),i(23,"div",9)(24,"mat-form-field",10)(25,"mat-label"),o(26,"Descripci\xF3n (opcional)"),n(),f(27,"textarea",14),i(28,"mat-hint",12),o(29),n()()(),i(30,"div",9),f(31,"input",15),i(32,"mat-form-field",10)(33,"mat-label"),o(34,"Categor\xEDa Padre (opcional)"),n(),i(35,"mat-select",16)(36,"mat-option",17),o(37,"Ninguna"),n(),m(38,Ce,2,2,"mat-option",18),n()()()(),i(39,"div",8)(40,"h3"),o(41,"Personalizaci\xF3n Visual"),n(),i(42,"div",9)(43,"div",19)(44,"label",20),o(45,"Color de la categor\xEDa"),n(),i(46,"div",21),m(47,_e,2,6,"button",22),n(),m(48,ve,2,0,"mat-error",13),n()(),i(49,"div",9)(50,"div",23)(51,"label",20),o(52,"Icono de la categor\xEDa"),n(),i(53,"div",24),m(54,he,3,4,"button",25),n(),m(55,be,2,0,"mat-error",13),n()()(),i(56,"div",8)(57,"h3"),o(58,"Estado"),n(),i(59,"div",9)(60,"div",26)(61,"mat-checkbox",27),o(62,"Categor\xEDa activa"),n(),i(63,"mat-hint"),o(64,"Las categor\xEDas inactivas no aparecer\xE1n en nuevos registros."),n()()()()()(),i(65,"div",28)(66,"button",29),o(67,"Cancelar"),n(),i(68,"button",30),d("click",function(){return a.onSave()}),m(69,xe,1,0,"mat-spinner",31)(70,ye,2,1,"span",13),n()()()),e&2){let s,l;c(6),C(a.getDialogTitle()),c(5),g("formGroup",a.categoriaForm),c(10),_("",((s=a.categoriaForm.get("nombre"))==null||s.value==null?null:s.value.length)||0,"/50"),c(),g("ngIf",a.hasError("nombre","required")),c(7),_("",((l=a.categoriaForm.get("descripcion"))==null||l.value==null?null:l.value.length)||0,"/200"),c(7),g("value",null),c(2),g("ngForOf",a.availableParentCategories),c(9),g("ngForOf",a.availableColors),c(),g("ngIf",a.hasError("color","required")),c(6),g("ngForOf",a.availableIcons),c(),g("ngIf",a.hasError("icono","required")),c(13),g("disabled",a.categoriaForm.invalid||a.saving),c(),g("ngIf",a.saving),c(),g("ngIf",!a.saving)}},dependencies:[vt,T,Pt,xt,yt,Mt,wt,Et,Ot,St,F,z,E,Jt,qt,Vt,Ht,$t,Yt,Gt,te,L,ne],styles:['@charset "UTF-8";.color-selection[_ngcontent-%COMP%], .icon-selection[_ngcontent-%COMP%]{width:100%}.selection-label[_ngcontent-%COMP%]{display:block;font-size:14px;font-weight:500;color:var(--mat-sys-on-surface-variant);margin-bottom:12px}.color-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(40px,1fr));gap:12px}.color-option[_ngcontent-%COMP%]{width:40px;height:40px;border-radius:50%;cursor:pointer;border:2px solid var(--mat-sys-outline-variant);transition:all .2s ease-in-out;display:flex;align-items:center;justify-content:center}.color-option[_ngcontent-%COMP%]:hover{transform:scale(1.1);border-color:var(--mat-sys-primary)}.color-option.selected[_ngcontent-%COMP%]{border-color:var(--mat-sys-primary);border-width:3px;box-shadow:var(--mat-sys-elevation-level2)}.color-option[_ngcontent-%COMP%]   .check-icon[_ngcontent-%COMP%]{color:#fff;font-size:20px;font-weight:700;text-shadow:0 1px 2px rgba(0,0,0,.5)}.icon-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(48px,1fr));gap:12px}.icon-option[_ngcontent-%COMP%]{width:48px;height:48px;border-radius:12px;cursor:pointer;border:1px solid var(--mat-sys-outline-variant);background-color:var(--mat-sys-surface-container);transition:all .2s ease-in-out;display:flex;align-items:center;justify-content:center;color:var(--mat-sys-on-surface-variant)}.icon-option[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:24px}.icon-option[_ngcontent-%COMP%]:hover{transform:translateY(-2px);border-color:var(--mat-sys-primary);background-color:var(--mat-sys-primary-container);color:var(--mat-sys-primary)}.icon-option.selected[_ngcontent-%COMP%]{background-color:var(--mat-sys-primary);color:var(--mat-sys-on-primary);border-color:var(--mat-sys-primary);box-shadow:var(--mat-sys-elevation-level2)}']})};var Me=()=>[10,25,50];function Pe(r,t){r&1&&(i(0,"th",17),o(1,"Categor\xEDa"),n())}function Oe(r,t){if(r&1&&(i(0,"td",18)(1,"div",19)(2,"mat-icon"),o(3),n(),i(4,"div")(5,"div",20),o(6),n(),i(7,"div",21),o(8),n()()()()),r&2){let e=t.$implicit;c(2),H("color",e.color),c(),C(e.icono||"category"),c(3),C(e.nombre),c(2),C(e.descripcion||"Sin descripci\xF3n")}}function Se(r,t){r&1&&(i(0,"th",22),o(1,"Estado"),n())}function we(r,t){if(r&1&&(i(0,"td",18)(1,"span",23),o(2),n()()),r&2){let e=t.$implicit;c(),k("active",e.activa)("inactive",!e.activa),c(),_(" ",e.activa?"Activa":"Inactiva"," ")}}function Ee(r,t){r&1&&(i(0,"th",17),o(1,"Creada"),n())}function Ie(r,t){if(r&1&&(i(0,"td",18),o(1),n()),r&2){let e=t.$implicit,a=p(2);c(),_(" ",a.formatDate(e.fechaCreacion)," ")}}function De(r,t){r&1&&(i(0,"th",24),o(1,"Acciones"),n())}function ke(r,t){if(r&1){let e=S();i(0,"td",25)(1,"div",26)(2,"button",27),d("click",function(){let s=h(e).$implicit,l=p(2);return b(l.editCategoria.emit(s))}),i(3,"mat-icon"),o(4,"edit"),n()(),i(5,"button",28),d("click",function(){let s=h(e).$implicit,l=p(2);return b(l.onDuplicate(s))}),i(6,"mat-icon"),o(7,"content_copy"),n()(),i(8,"button",29),d("click",function(){let s=h(e).$implicit,l=p(2);return b(l.toggleStatus.emit(s))}),i(9,"mat-icon"),o(10),n()(),i(11,"button",30),d("click",function(){let s=h(e).$implicit,l=p(2);return b(l.deleteCategoria.emit(s))}),i(12,"mat-icon"),o(13,"delete"),n()()()()}if(r&2){let e=t.$implicit;c(8),g("matTooltip",e.activa?"Desactivar":"Activar"),c(2),C(e.activa?"toggle_off":"toggle_on")}}function Te(r,t){r&1&&f(0,"tr",31)}function ze(r,t){r&1&&f(0,"tr",32)}function Fe(r,t){if(r&1&&(i(0,"div",3)(1,"table",4),N(2,5),m(3,Pe,2,0,"th",6)(4,Oe,9,5,"td",7),j(),N(5,8),m(6,Se,2,0,"th",9)(7,we,3,5,"td",7),j(),N(8,10),m(9,Ee,2,0,"th",6)(10,Ie,2,1,"td",7),j(),N(11,11),m(12,De,2,0,"th",12)(13,ke,14,2,"td",13),j(),m(14,Te,1,0,"tr",14)(15,ze,1,0,"tr",15),n(),f(16,"mat-paginator",16),n()),r&2){let e=p();c(),g("dataSource",e.dataSource),c(13),g("matHeaderRowDef",e.displayedColumns),c(),g("matRowDefColumns",e.displayedColumns),c(),g("pageSizeOptions",_t(4,Me))}}function Le(r,t){if(r&1){let e=S();i(0,"div",35)(1,"div",36)(2,"mat-icon",37),o(3,"category"),n(),i(4,"h3",38),o(5,"No hay categor\xEDas"),n(),i(6,"p",39),o(7,"Crea tu primera categor\xEDa para empezar a organizar tus finanzas."),n(),i(8,"button",40),d("click",function(){h(e);let s=p(2);return b(s.addCategoria.emit())}),i(9,"mat-icon"),o(10,"add"),n(),i(11,"span"),o(12,"Crear Categor\xEDa"),n()()()()}}function Ae(r,t){r&1&&(i(0,"div",41)(1,"div",36),f(2,"mat-spinner",42),i(3,"p",39),o(4,"Cargando categor\xEDas..."),n()()())}function Ne(r,t){if(r&1&&m(0,Le,13,0,"div",33)(1,Ae,5,0,"div",34),r&2){let e=p();g("ngIf",!e.loading&&(!e.categorias||e.categorias.length===0)),c(),g("ngIf",e.loading)}}var J=class r{categorias=null;loading=!1;showHierarchy=!1;editCategoria=new D;cloneCategoria=new D;deleteCategoria=new D;duplicateCategoria=new D;toggleStatus=new D;addCategoria=new D;paginator;sort;dataSource=new Ut;displayedColumns=["nombre","estado","fechaCreacion","acciones"];ngOnInit(){this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort}ngOnChanges(t){t.categorias&&this.categorias&&(this.dataSource.data=this.categorias)}formatDate(t){if(!t)return"N/A";let e=typeof t=="string"?new Date(t):t;return isNaN(e.getTime())?"Fecha inv\xE1lida":e.toLocaleDateString("es-ES",{year:"numeric",month:"short",day:"numeric"})}onClone(t){this.cloneCategoria.emit(t)}onDuplicate(t){this.duplicateCategoria.emit(t)}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=O({type:r,selectors:[["app-categorias-list"]],viewQuery:function(e,a){if(e&1&&(tt(Q,5),tt(W,5)),e&2){let s;et(s=at())&&(a.paginator=s.first),et(s=at())&&(a.sort=s.first)}},inputs:{categorias:"categorias",loading:"loading",showHierarchy:"showHierarchy"},outputs:{editCategoria:"editCategoria",cloneCategoria:"cloneCategoria",deleteCategoria:"deleteCategoria",duplicateCategoria:"duplicateCategoria",toggleStatus:"toggleStatus",addCategoria:"addCategoria"},standalone:!1,features:[V],decls:4,vars:2,consts:[["emptyOrLoading",""],[1,"list-container"],["class","table-container",4,"ngIf","ngIfElse"],[1,"table-container"],["mat-table","","matSort","",1,"mat-mdc-table",3,"dataSource"],["matColumnDef","nombre"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","estado"],["mat-header-cell","",4,"matHeaderCellDef"],["matColumnDef","fechaCreacion"],["matColumnDef","acciones"],["mat-header-cell","","class","actions-header",4,"matHeaderCellDef"],["mat-cell","","class","actions-cell",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["showFirstLastButtons","",3,"pageSizeOptions"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],[2,"display","flex","align-items","center","gap","12px"],[2,"font-weight","500"],[2,"font-size","12px","opacity","0.7"],["mat-header-cell",""],[1,"status-chip"],["mat-header-cell","",1,"actions-header"],["mat-cell","",1,"actions-cell"],[1,"actions-container"],["mat-icon-button","","color","primary","matTooltip","Editar",1,"action-button",3,"click"],["mat-icon-button","","color","accent","matTooltip","Clonar",1,"action-button",3,"click"],["mat-icon-button","",1,"action-button",3,"click","matTooltip"],["mat-icon-button","","color","warn","matTooltip","Eliminar",1,"action-button",3,"click"],["mat-header-row",""],["mat-row",""],["class","empty-state",4,"ngIf"],["class","loading-state",4,"ngIf"],[1,"empty-state"],[1,"content-wrapper"],[1,"state-icon"],[1,"title"],[1,"message"],["mat-raised-button","","color","primary",1,"action-button",3,"click"],[1,"loading-state"],["diameter","50"]],template:function(e,a){if(e&1&&(i(0,"div",1),m(1,Fe,17,5,"div",2)(2,Ne,2,2,"ng-template",null,0,Y),n()),e&2){let s=$(3);c(),g("ngIf",!a.loading&&a.dataSource.data.length>0)("ngIfElse",s)}},dependencies:[T,F,z,E,kt,zt,Nt,Ft,Tt,jt,Lt,At,Bt,Rt,Q,W,Wt,L,Qt],styles:['@charset "UTF-8";.mat-mdc-chip[_ngcontent-%COMP%]{font-size:12px;font-weight:500;padding:4px 8px;min-height:24px;border-radius:12px}']})};function Be(r,t){if(r&1&&(i(0,"div",20)(1,"div",8)(2,"mat-icon"),o(3,"cancel"),n()(),i(4,"div",9)(5,"div",10),o(6),n(),i(7,"div",11),o(8,"Categor\xEDas Inactivas"),n(),i(9,"div",12),o(10,"No est\xE1n en uso"),n(),i(11,"div",13)(12,"mat-icon"),o(13,"warning"),n(),i(14,"span"),o(15),n()()()()),r&2){let e=p(2);c(6),C(e.stats.categoriasInactivas),c(9),_("",e.formatPercentage(e.stats.categoriasInactivas/e.stats.totalCategorias*100)," del total")}}function Re(r,t){if(r&1&&(i(0,"div",6)(1,"div",7)(2,"div",8)(3,"mat-icon"),o(4,"category"),n()(),i(5,"div",9)(6,"div",10),o(7),n(),i(8,"div",11),o(9,"Total Categor\xEDas"),n(),i(10,"div",12),o(11,"Todas las categor\xEDas de gastos"),n(),i(12,"div",13)(13,"span"),o(14),n()()()(),i(15,"div",14)(16,"div",8)(17,"mat-icon"),o(18,"check_circle"),n()(),i(19,"div",9)(20,"div",10),o(21),n(),i(22,"div",11),o(23,"Categor\xEDas Activas"),n(),i(24,"div",12),o(25,"En uso actualmente"),n(),i(26,"div",13)(27,"span"),o(28),n()()()(),i(29,"div",15)(30,"div",8)(31,"mat-icon"),o(32,"account_tree"),n()(),i(33,"div",9)(34,"div",10),o(35),n(),i(36,"div",11),o(37,"Total Subcategor\xEDas"),n(),i(38,"div",12),o(39,"Categor\xEDas anidadas"),n(),i(40,"div",13)(41,"span"),o(42),n()()()(),i(43,"div",14)(44,"div",8)(45,"mat-icon"),o(46,"speed"),n()(),i(47,"div",9)(48,"div",10),o(49),n(),i(50,"div",11),o(51,"Eficiencia de Uso"),n(),i(52,"div",12),o(53,"Categor\xEDas activas"),n(),i(54,"div",16),f(55,"mat-progress-bar",17),n(),i(56,"div",13)(57,"span"),o(58),n()()()(),m(59,Be,16,2,"div",18),i(60,"div",19)(61,"div",8)(62,"mat-icon"),o(63,"folder_open"),n()(),i(64,"div",9)(65,"div",10),o(66),n(),i(67,"div",11),o(68,"Nivel de Organizaci\xF3n"),n(),i(69,"div",12),o(70,"Estructura de categor\xEDas"),n(),i(71,"div",13)(72,"span"),o(73),n()()()()()),r&2){let e=p();c(7),C(e.stats.totalCategorias),c(7),_("",e.stats.categoriasPadre," categor\xEDas padre"),c(7),C(e.stats.categoriasActivas),c(7),_("",e.formatPercentage(e.stats.porcentajeActivas)," del total"),c(7),C(e.stats.subcategorias),c(7),_("",e.stats.categoriasPadre," categor\xEDas padre"),c(7),C(e.formatPercentage(e.stats.eficienciaUso)),c(6),g("value",e.stats.eficienciaUso),c(3),pt("",e.stats.categoriasActivas," de ",e.stats.totalCategorias," activas"),c(),g("ngIf",e.stats.categoriasInactivas>0),c(7),C(e.getOrganizationLevel()),c(7),_("",e.getAverageSubcategories()," subcategor\xEDas promedio")}}function Ue(r,t){r&1&&(i(0,"div",21),f(1,"mat-spinner",22),i(2,"p"),o(3,"Cargando estad\xEDsticas..."),n()())}function Ve(r,t){r&1&&(i(0,"div",23)(1,"mat-icon"),o(2,"category"),n(),i(3,"h4"),o(4,"No hay categor\xEDas registradas"),n(),i(5,"p"),o(6,"Crea tu primera categor\xEDa para ver las estad\xEDsticas"),n()())}var K=class r{categorias=null;loading=!1;stats={totalCategorias:0,categoriasActivas:0,categoriasInactivas:0,categoriasPadre:0,subcategorias:0,porcentajeActivas:0,ultimaCreacion:null,coloresUsados:0,iconosUsados:0,eficienciaUso:0};ngOnChanges(t){t.categorias&&this.categorias&&this.calculateStats()}calculateStats(){if(!this.categorias||this.categorias.length===0){this.resetStats();return}let t=this.categorias.length,e=this.categorias.filter(u=>u.activa).length,a=t-e,s=this.categorias.filter(u=>!u.categoriaParentId).length,l=this.categorias.filter(u=>u.categoriaParentId).length,y=new Set(this.categorias.map(u=>u.color).filter(Boolean)),x=new Set(this.categorias.map(u=>u.icono).filter(Boolean)),st=this.categorias.map(u=>u.fechaCreacion).filter(u=>u!==void 0).map(u=>new Date(u)).sort((u,de)=>de.getTime()-u.getTime());this.stats={totalCategorias:t,categoriasActivas:e,categoriasInactivas:a,categoriasPadre:s,subcategorias:l,porcentajeActivas:t>0?e/t*100:0,ultimaCreacion:st.length>0?st[0]:null,coloresUsados:y.size,iconosUsados:x.size,eficienciaUso:t>0?e/t*100:0}}resetStats(){this.stats={totalCategorias:0,categoriasActivas:0,categoriasInactivas:0,categoriasPadre:0,subcategorias:0,porcentajeActivas:0,ultimaCreacion:null,coloresUsados:0,iconosUsados:0,eficienciaUso:0}}refreshStats(){this.categorias&&this.calculateStats()}getAverageSubcategories(){return this.stats.categoriasPadre===0?"0":(this.stats.subcategorias/this.stats.categoriasPadre).toFixed(1)}getUsageEfficiency(){return this.stats.totalCategorias===0?0:Math.round(this.stats.categoriasActivas/this.stats.totalCategorias*100)}formatDate(t){if(!t)return"Fecha no disponible";let e=t instanceof Date?t:new Date(t);return isNaN(e.getTime())?"Fecha inv\xE1lida":e.toLocaleDateString("es-ES",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}hasCategories(){return this.categorias!==null&&this.categorias.length>0}getStatusColor(t){return t>=80?"primary":t>=60?"accent":t>=40?"warn":"basic"}getHealthStatus(){let t=this.stats.porcentajeActivas;return t>=80?"Excelente":t>=60?"Bueno":t>=40?"Regular":"Necesita atenci\xF3n"}getOrganizationLevel(){let t=this.stats.categoriasPadre>0?this.stats.subcategorias/this.stats.categoriasPadre:0;return t>=3?"Muy organizado":t>=2?"Bien organizado":t>=1?"Organizaci\xF3n b\xE1sica":"Sin subcategor\xEDas"}get currentDate(){return new Date}formatPercentage(t){return`${t.toFixed(1)}%`}getTopCategories(){return this.categorias?this.categorias.filter(t=>t.activa).slice(0,5):[]}getSubcategoriesCount(t){return!t||!this.categorias?0:this.categorias.filter(e=>e.categoriaParentId===t.id).length}getMostUsedCategory(){if(!this.categorias)return null;let t=this.categorias.filter(e=>!e.categoriaParentId&&e.activa).map(e=>({categoria:e,subcategorias:this.getSubcategoriesCount(e)})).sort((e,a)=>a.subcategorias-e.subcategorias);return t.length>0?t[0].categoria:null}getOldestCategory(){if(!this.categorias)return null;let t=this.categorias.filter(e=>e.fechaCreacion).sort((e,a)=>new Date(e.fechaCreacion).getTime()-new Date(a.fechaCreacion).getTime());return t.length>0?t[0]:null}getTopCategoriesBySubcategories(){return this.categorias?this.categorias.filter(t=>!t.categoriaParentId).map(t=>({categoria:t,subcategorias:this.getSubcategoriesCount(t)})).sort((t,e)=>e.subcategorias-t.subcategorias).slice(0,5).map(t=>t.categoria):[]}getCategoryAlerts(){let t=[];return this.stats.categoriasInactivas>this.stats.categoriasActivas&&t.push({type:"warning",icon:"warning",title:"Muchas categor\xEDas inactivas",message:`Tienes ${this.stats.categoriasInactivas} categor\xEDas inactivas. Considera activarlas o eliminarlas.`}),this.stats.categoriasPadre>0&&this.stats.subcategorias===0&&t.push({type:"error",icon:"lightbulb_outline",title:"Organizaci\xF3n mejorable",message:"Considera crear subcategor\xEDas para una mejor organizaci\xF3n de tus finanzas."}),t}getActiveCategories(){return this.categorias?this.categorias.filter(t=>t.activa):[]}getInactiveCategories(){return this.categorias?this.categorias.filter(t=>!t.activa):[]}getParentCategories(){return this.categorias?this.categorias.filter(t=>!t.categoriaParentId):[]}getSubcategories(){return this.categorias?this.categorias.filter(t=>t.categoriaParentId):[]}getCategoryStatusClass(t){return t.activa?"active":"inactive"}getEfficiencyColor(){let t=this.getUsageEfficiency();return t>=80?"success":t>=60?"warning":"error"}getCreationTrend(){if(!this.stats.ultimaCreacion)return"Sin datos";let t=new Date,e=new Date(this.stats.ultimaCreacion),a=Math.floor((t.getTime()-e.getTime())/(1e3*60*60*24));return a<=7?"Reciente":a<=30?"Este mes":a<=90?"\xDAltimos 3 meses":"Hace tiempo"}getOrganizationScore(){let t=0;this.stats.porcentajeActivas>=80?t+=30:this.stats.porcentajeActivas>=60?t+=20:this.stats.porcentajeActivas>=40&&(t+=10);let e=this.stats.categoriasPadre>0?this.stats.subcategorias/this.stats.categoriasPadre:0;return e>=2?t+=25:e>=1?t+=15:e>0&&(t+=10),this.stats.coloresUsados>=this.stats.totalCategorias*.8?t+=10:this.stats.coloresUsados>=this.stats.totalCategorias*.5&&(t+=5),this.stats.iconosUsados>=this.stats.totalCategorias*.8?t+=10:this.stats.iconosUsados>=this.stats.totalCategorias*.5&&(t+=5),Math.min(t,100)}getOrganizationScoreColor(){let t=this.getOrganizationScore();return t>=80?"success":t>=60?"warning":"error"}getOrganizationScoreLabel(){let t=this.getOrganizationScore();return t>=90?"Excelente":t>=80?"Muy bueno":t>=70?"Bueno":t>=60?"Regular":t>=40?"Mejorable":"Necesita atenci\xF3n"}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=O({type:r,selectors:[["app-categorias-stats"]],inputs:{categorias:"categorias",loading:"loading"},standalone:!1,features:[V],decls:13,vars:6,consts:[["loadingTemplate",""],[1,"prestamo-stats"],[1,"stats-header"],["mat-icon-button","",3,"click","disabled"],["class","stats-grid",4,"ngIf","ngIfElse"],["class","stats-empty",4,"ngIf"],[1,"stats-grid"],[1,"stat-card","primary"],[1,"stat-icon"],[1,"stat-content"],[1,"stat-value"],[1,"stat-label"],[1,"stat-description"],[1,"stat-trend"],[1,"stat-card","success"],[1,"stat-card","secondary"],[1,"stat-progress"],["mode","determinate",3,"value"],["class","stat-card danger",4,"ngIf"],[1,"stat-card","info"],[1,"stat-card","danger"],[1,"stats-loading"],["diameter","40"],[1,"stats-empty"]],template:function(e,a){if(e&1){let s=S();i(0,"div",1)(1,"div",2)(2,"h3")(3,"mat-icon"),o(4,"analytics"),n(),o(5," Estad\xEDsticas Generales "),n(),i(6,"button",3),d("click",function(){return h(s),b(a.calculateStats())}),i(7,"mat-icon"),o(8,"refresh"),n()()(),m(9,Re,74,13,"div",4)(10,Ue,4,0,"ng-template",null,0,Y)(12,Ve,7,0,"div",5),n()}if(e&2){let s=$(11);c(6),g("disabled",a.loading),c(),k("spinning",a.loading),c(2),g("ngIf",!a.loading&&a.hasCategories())("ngIfElse",s),c(3),g("ngIf",!a.loading&&!a.hasCategories())}},dependencies:[T,z,E,L,oe],styles:['.prestamo-stats[_ngcontent-%COMP%]{padding:16px;background-color:var(--mat-sys-surface-container-low);border-radius:8px;border:1px solid var(--mat-sys-outline-variant)}.stats-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:24px}.stats-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;display:flex;align-items:center;gap:8px;color:var(--mat-sys-primary);font-weight:500;font-size:18px}.stats-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{font-size:24px;width:24px;height:24px}.stats-header[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{transition:transform .3s ease}.stats-header[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   .mat-icon.spinning[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_spin 1s linear infinite}.stats-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:16px}@media (min-width: 1200px){.stats-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(4,1fr)}}@media (max-width: 768px){.stats-grid[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:12px}}.stat-card[_ngcontent-%COMP%]{background:var(--mat-sys-surface-container-low);border-radius:12px;padding:20px;box-shadow:var(--mat-sys-elevation-level2);border:1px solid var(--mat-sys-outline-variant);transition:all .3s ease;position:relative;overflow:hidden;display:flex;align-items:flex-start;gap:16px}.stat-card[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:var(--mat-sys-elevation-level3)}.stat-card[_ngcontent-%COMP%]:before{content:"";position:absolute;top:0;left:0;right:0;height:4px;background:var(--mat-sys-outline-variant)}.stat-card.primary[_ngcontent-%COMP%]:before{background:var(--mat-sys-primary)}.stat-card.secondary[_ngcontent-%COMP%]:before{background:var(--mat-sys-secondary)}.stat-card.info[_ngcontent-%COMP%]:before{background:var(--mat-sys-info)}.stat-card.success[_ngcontent-%COMP%]:before{background:var(--mat-sys-success)}.stat-card.warning[_ngcontent-%COMP%]:before{background:var(--mat-sys-warning)}.stat-card.danger[_ngcontent-%COMP%]:before{background:var(--mat-sys-error)}.stat-card.alert[_ngcontent-%COMP%]:before{background:var(--mat-sys-error)}.stat-card.pending[_ngcontent-%COMP%]:before{background:var(--mat-sys-tertiary)}.stat-icon[_ngcontent-%COMP%]{flex-shrink:0;width:48px;height:48px;border-radius:12px;display:flex;align-items:center;justify-content:center;background-color:var(--mat-sys-surface-variant)}.stat-icon[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{font-size:24px;width:24px;height:24px;color:var(--mat-sys-on-surface-variant)}.primary[_ngcontent-%COMP%]   .stat-icon[_ngcontent-%COMP%]{background-color:var(--mat-sys-primary-container)}.primary[_ngcontent-%COMP%]   .stat-icon[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{color:var(--mat-sys-on-primary-container)}.secondary[_ngcontent-%COMP%]   .stat-icon[_ngcontent-%COMP%]{background-color:var(--mat-sys-secondary-container)}.secondary[_ngcontent-%COMP%]   .stat-icon[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{color:var(--mat-sys-on-secondary-container)}.info[_ngcontent-%COMP%]   .stat-icon[_ngcontent-%COMP%]{background-color:var(--mat-sys-info-container)}.info[_ngcontent-%COMP%]   .stat-icon[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{color:var(--mat-sys-on-info-container)}.success[_ngcontent-%COMP%]   .stat-icon[_ngcontent-%COMP%]{background-color:var(--mat-sys-success-container)}.success[_ngcontent-%COMP%]   .stat-icon[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{color:var(--mat-sys-on-success-container)}.warning[_ngcontent-%COMP%]   .stat-icon[_ngcontent-%COMP%]{background-color:var(--mat-sys-warning-container)}.warning[_ngcontent-%COMP%]   .stat-icon[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{color:var(--mat-sys-on-warning-container)}.danger[_ngcontent-%COMP%]   .stat-icon[_ngcontent-%COMP%]{background-color:var(--mat-sys-error-container)}.danger[_ngcontent-%COMP%]   .stat-icon[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{color:var(--mat-sys-on-error-container)}.alert[_ngcontent-%COMP%]   .stat-icon[_ngcontent-%COMP%]{background-color:var(--mat-sys-error-container)}.alert[_ngcontent-%COMP%]   .stat-icon[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{color:var(--mat-sys-on-error-container)}.pending[_ngcontent-%COMP%]   .stat-icon[_ngcontent-%COMP%]{background-color:var(--mat-sys-tertiary-container)}.pending[_ngcontent-%COMP%]   .stat-icon[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{color:var(--mat-sys-on-tertiary-container)}.stat-content[_ngcontent-%COMP%]{flex:1;min-width:0}.stat-value[_ngcontent-%COMP%]{font-size:24px;font-weight:700;color:var(--mat-sys-on-surface);margin-bottom:4px;line-height:1.2}@media (max-width: 480px){.stat-value[_ngcontent-%COMP%]{font-size:20px}}.stat-label[_ngcontent-%COMP%]{font-size:14px;color:var(--mat-sys-on-surface-variant);font-weight:500;margin-bottom:4px;text-transform:uppercase;letter-spacing:.5px}.stat-description[_ngcontent-%COMP%]{font-size:12px;color:var(--mat-sys-outline);margin-bottom:8px;font-style:italic;line-height:1.3}.stat-trend[_ngcontent-%COMP%]{display:flex;align-items:center;gap:4px;font-size:12px;color:var(--mat-sys-outline)}.stat-trend[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{font-size:16px;width:16px;height:16px}.stat-trend.positive[_ngcontent-%COMP%], .stat-trend.positive[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{color:var(--mat-sys-success)}.stat-trend.warning[_ngcontent-%COMP%], .stat-trend.warning[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{color:var(--mat-sys-warning)}.stat-progress[_ngcontent-%COMP%]{margin:8px 0}.stat-progress[_ngcontent-%COMP%]   .mat-progress-bar[_ngcontent-%COMP%]{height:6px;border-radius:3px}.stat-progress[_ngcontent-%COMP%]   .mat-progress-bar[_ngcontent-%COMP%]     .mat-progress-bar-fill:after{background-color:var(--mat-sys-success)}.stat-progress[_ngcontent-%COMP%]   .mat-progress-bar[_ngcontent-%COMP%]     .mat-progress-bar-buffer{background-color:var(--mat-sys-outline-variant)}.alert-details[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:4px;margin-top:8px}.alert-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:6px;font-size:12px}.alert-item[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{font-size:14px;width:14px;height:14px}.alert-item[_ngcontent-%COMP%]   .mat-icon.danger[_ngcontent-%COMP%]{color:var(--mat-sys-error)}.alert-item[_ngcontent-%COMP%]   .mat-icon.warning[_ngcontent-%COMP%]{color:var(--mat-sys-warning)}.stats-loading[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:40px 20px;text-align:center}.stats-loading[_ngcontent-%COMP%]   .mat-spinner[_ngcontent-%COMP%]{margin-bottom:16px}.stats-loading[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;color:var(--mat-sys-on-surface-variant);font-size:14px}.stats-empty[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:40px 20px;text-align:center;color:var(--mat-sys-on-surface-variant)}.stats-empty[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{font-size:48px;width:48px;height:48px;margin-bottom:16px;color:var(--mat-sys-outline)}.stats-empty[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 8px;font-size:18px;font-weight:500}.stats-empty[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:14px;color:var(--mat-sys-outline)}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.stat-card[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeInUp .3s ease-out}@keyframes _ngcontent-%COMP%_fadeInUp{0%{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}@media (max-width: 768px){.prestamo-stats[_ngcontent-%COMP%]{padding:12px}.stats-header[_ngcontent-%COMP%]{margin-bottom:16px}.stats-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:16px}.stats-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{font-size:20px;width:20px;height:20px}.stat-card[_ngcontent-%COMP%]{padding:16px;gap:12px}.stat-icon[_ngcontent-%COMP%]{width:40px;height:40px}.stat-icon[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{font-size:20px;width:20px;height:20px}.stat-value[_ngcontent-%COMP%]{font-size:20px}.stat-label[_ngcontent-%COMP%]{font-size:12px}.stat-trend[_ngcontent-%COMP%]{font-size:11px}.stat-trend[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{font-size:14px;width:14px;height:14px}}@media (max-width: 480px){.prestamo-stats[_ngcontent-%COMP%]{padding:8px}.stats-header[_ngcontent-%COMP%]{margin-bottom:12px;flex-direction:column;align-items:flex-start;gap:8px}.stats-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:15px}.stat-card[_ngcontent-%COMP%]{padding:12px;gap:10px}.stat-card[_ngcontent-%COMP%]:hover{transform:none}.stat-icon[_ngcontent-%COMP%]{width:36px;height:36px}.stat-icon[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{font-size:18px;width:18px;height:18px}.stat-value[_ngcontent-%COMP%]{font-size:18px}.stat-label[_ngcontent-%COMP%]{font-size:11px;margin-bottom:6px}.stat-trend[_ngcontent-%COMP%]{font-size:10px}.stat-trend[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{font-size:12px;width:12px;height:12px}.alert-details[_ngcontent-%COMP%]{gap:2px}.alert-item[_ngcontent-%COMP%]{font-size:10px}.alert-item[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{font-size:12px;width:12px;height:12px}}.stat-card[_ngcontent-%COMP%]:focus-within{outline:2px solid var(--mat-sys-primary);outline-offset:2px}.stats-header[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:focus{outline:2px solid var(--mat-sys-primary);outline-offset:2px}.stat-card[_ngcontent-%COMP%], .stat-icon[_ngcontent-%COMP%], .stat-value[_ngcontent-%COMP%], .stat-label[_ngcontent-%COMP%], .stat-trend[_ngcontent-%COMP%]{transition:all .2s ease}.stat-value.negative[_ngcontent-%COMP%]{color:var(--mat-sys-error)}.stat-value.positive[_ngcontent-%COMP%]{color:var(--mat-sys-success)}.stat-value.warning[_ngcontent-%COMP%]{color:var(--mat-sys-warning)}.stat-card.pulsing[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_pulse 2s infinite}@keyframes _ngcontent-%COMP%_pulse{0%{box-shadow:var(--mat-sys-elevation-level2)}50%{box-shadow:var(--mat-sys-elevation-level4)}to{box-shadow:var(--mat-sys-elevation-level2)}}.stat-card[title][_ngcontent-%COMP%]{cursor:help}.stat-card[_ngcontent-%COMP%]{will-change:transform,box-shadow}.stat-icon[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{will-change:transform}']})};var X=class r{constructor(t,e,a){this.categoriasService=t;this.dialog=e;this.snackBar=a;this.categorias$=this.categoriasService.getCategorias(),this.categoriasHierarchy$=this.categoriasService.getCategoriaHierarchy()}destroy$=new ct;categorias$;categoriasHierarchy$;loading=!1;selectedTabIndex=0;ngOnInit(){this.loadData()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}loadData(){}onTabChange(t){this.selectedTabIndex=t.index}openCategoriaDialog(t){this.dialog.open(R,{width:"80vw",maxHeight:"80vh",panelClass:"unified-modal-panel",data:{categoria:t||null,mode:t?"edit":"create"},disableClose:!0}).afterClosed().pipe(U(this.destroy$)).subscribe(a=>{a&&(t?this.updateCategoria(a):this.createCategoria(a))})}createCategoria(t){if(!t||!t.nombre){console.error("Error: Datos de categor\xEDa inv\xE1lidos",t),this.showMessage("Error: Datos de categor\xEDa inv\xE1lidos");return}if("id"in t&&t.id)this.categoriasService.addCategoria(t);else{let e={id:Date.now().toString(),nombre:t.nombre,descripcion:t.descripcion,tipo:"gasto",color:t.color,icono:t.icono,activa:t.activa??!0,categoriaParentId:t.categoriaParentId||void 0,fechaCreacion:new Date().toISOString().split("T")[0]};this.categoriasService.addCategoria(e)}this.showMessage("Categor\xEDa creada exitosamente")}updateCategoria(t){this.categoriasService.updateCategoria(t.id,t),this.showMessage("Categor\xEDa actualizada exitosamente")}deleteCategoria(t){confirm(`\xBFEst\xE1s seguro de que deseas eliminar la categor\xEDa "${t.nombre}"?`)&&(this.categoriasService.deleteCategoria(t.id),this.showMessage("Categor\xEDa eliminada exitosamente"))}duplicateCategoria(t){this.dialog.open(R,{width:"80vw",maxHeight:"80vh",panelClass:"unified-modal-panel",data:{categoria:t,mode:"duplicate"},disableClose:!0}).afterClosed().pipe(U(this.destroy$)).subscribe(a=>{a&&(this.createCategoria(a),this.showMessage("Categor\xEDa duplicada exitosamente"))})}toggleCategoriaStatus(t){this.categoriasService.toggleCategoriaStatus(t.id);let e=t.activa?"desactivada":"activada";this.showMessage(`Categor\xEDa ${e} exitosamente`)}showMessage(t){this.snackBar.open(t,"Cerrar",{duration:3e3,horizontalPosition:"end",verticalPosition:"top"})}refreshData(){this.loadData()}exportCategorias(){this.categoriasService.exportCategorias().pipe(U(this.destroy$)).subscribe(t=>{let e=new Blob([t],{type:"application/json"}),a=window.URL.createObjectURL(e),s=document.createElement("a");s.href=a,s.download=`categorias-${new Date().toISOString().split("T")[0]}.json`,s.click(),window.URL.revokeObjectURL(a),this.showMessage("Categor\xEDas exportadas exitosamente")})}importCategorias(t){let e=t.target;if(e.files&&e.files[0]){let a=e.files[0],s=new FileReader;s.onload=l=>{try{let y=l.target?.result;this.categoriasService.importCategorias(y)?this.showMessage("Categor\xEDas importadas exitosamente"):this.showMessage("Error al importar categor\xEDas: formato inv\xE1lido")}catch{this.showMessage("Error al leer el archivo")}},s.readAsText(a)}}static \u0275fac=function(e){return new(e||r)(P(I),P(Zt),P(ee))};static \u0275cmp=O({type:r,selectors:[["app-categorias"]],standalone:!1,decls:25,vars:14,consts:[[1,"categorias-container"],[1,"prestamos-header"],[1,"header-content"],[1,"page-title"],[1,"page-subtitle"],[1,"header-actions"],["mat-raised-button","","color","primary",3,"click"],[3,"categorias","loading"],[1,"categorias-tabs",3,"selectedIndexChange","selectedTabChange","selectedIndex"],["label","Todas"],[1,"tab-content"],[3,"editCategoria","deleteCategoria","duplicateCategoria","toggleStatus","categorias","loading"],["label","Jerarqu\xEDa"],[3,"editCategoria","deleteCategoria","duplicateCategoria","toggleStatus","categorias","loading","showHierarchy"]],template:function(e,a){e&1&&(i(0,"div",0)(1,"div",1)(2,"div",2)(3,"h1",3)(4,"mat-icon"),o(5,"category"),n(),o(6," Gesti\xF3n de Categor\xEDas "),n(),i(7,"p",4),o(8," Organiza tus gastos por categor\xEDas "),n()(),i(9,"div",5)(10,"button",6),d("click",function(){return a.openCategoriaDialog()}),i(11,"mat-icon"),o(12,"add"),n(),o(13," Nueva Categor\xEDa "),n()()(),f(14,"app-categorias-stats",7),q(15,"async"),i(16,"mat-tab-group",8),ft("selectedIndexChange",function(l){return Ct(a.selectedTabIndex,l)||(a.selectedTabIndex=l),l}),d("selectedTabChange",function(l){return a.onTabChange(l)}),i(17,"mat-tab",9)(18,"div",10)(19,"app-categorias-list",11),q(20,"async"),d("editCategoria",function(l){return a.openCategoriaDialog(l)})("deleteCategoria",function(l){return a.deleteCategoria(l)})("duplicateCategoria",function(l){return a.duplicateCategoria(l)})("toggleStatus",function(l){return a.toggleCategoriaStatus(l)}),n()()(),i(21,"mat-tab",12)(22,"div",10)(23,"app-categorias-list",13),q(24,"async"),d("editCategoria",function(l){return a.openCategoriaDialog(l)})("deleteCategoria",function(l){return a.deleteCategoria(l)})("duplicateCategoria",function(l){return a.duplicateCategoria(l)})("toggleStatus",function(l){return a.toggleCategoriaStatus(l)}),n()()()()()),e&2&&(c(14),g("categorias",G(15,8,a.categorias$))("loading",a.loading),c(2),ut("selectedIndex",a.selectedTabIndex),c(3),g("categorias",G(20,10,a.categorias$))("loading",a.loading),c(4),g("categorias",G(24,12,a.categoriasHierarchy$))("loading",a.loading)("showHierarchy",!0))},dependencies:[F,E,ae,ie,J,K,ht],styles:[".categorias-container[_ngcontent-%COMP%]{padding:24px;max-width:1400px;margin:0 auto;min-height:calc(100vh - 64px);background-color:var(--mat-sys-surface-dim);animation:_ngcontent-%COMP%_fadeIn .6s ease-out}.prestamos-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:32px;padding:24px;background:var(--mat-sys-surface-container-low);border-radius:16px;box-shadow:0 2px 12px var(--mat-sys-shadow);border:1px solid var(--mat-sys-outline-variant);animation:_ngcontent-%COMP%_slideInDown .6s ease-out}@media (max-width: 768px){.prestamos-header[_ngcontent-%COMP%]{flex-direction:column;gap:20px;align-items:stretch;padding:20px}}.header-content[_ngcontent-%COMP%]{flex:1}.page-title[_ngcontent-%COMP%]{margin:0 0 8px;font-size:28px;font-weight:700;color:var(--mat-sys-on-surface);display:flex;align-items:center;gap:12px}.page-title[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{font-size:32px;width:32px;height:32px;color:var(--mat-sys-primary)}@media (max-width: 768px){.page-title[_ngcontent-%COMP%]{font-size:24px}.page-title[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{font-size:28px;width:28px;height:28px}}.page-subtitle[_ngcontent-%COMP%]{margin:0;font-size:16px;color:var(--mat-sys-on-surface-variant);line-height:1.5}@media (max-width: 768px){.page-subtitle[_ngcontent-%COMP%]{font-size:14px}}.header-actions[_ngcontent-%COMP%]{display:flex;gap:12px;flex-shrink:0}@media (max-width: 768px){.header-actions[_ngcontent-%COMP%]{flex-direction:column;gap:8px}}@media (max-width: 480px){.header-actions[_ngcontent-%COMP%]{flex-direction:row;gap:8px}.header-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{flex:1;font-size:13px}.header-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{font-size:18px;width:18px;height:18px}}app-categorias-stats[_ngcontent-%COMP%]{display:block;animation:_ngcontent-%COMP%_slideInUp .6s ease-out .1s both}.categorias-tabs[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_slideInUp .6s ease-out .2s both;background:var(--mat-sys-surface);border-radius:12px;box-shadow:var(--mat-sys-elevation-level2);border:1px solid var(--mat-sys-outline-variant);overflow:hidden}.categorias-tabs[_ngcontent-%COMP%]     .mat-mdc-tab-group .mat-mdc-tab-header{background:var(--mat-sys-surface);border-bottom:1px solid var(--mat-sys-outline-variant)}.categorias-tabs[_ngcontent-%COMP%]     .mat-mdc-tab-group .mat-mdc-tab-header .mat-mdc-tab-label-container .mat-mdc-tab-list .mat-mdc-tab{min-width:120px;padding:0 24px;height:56px;font-weight:500;color:var(--mat-sys-on-surface-variant);transition:all .2s ease}.categorias-tabs[_ngcontent-%COMP%]     .mat-mdc-tab-group .mat-mdc-tab-header .mat-mdc-tab-label-container .mat-mdc-tab-list .mat-mdc-tab.mdc-tab--active{color:var(--mat-sys-primary);background:var(--mat-sys-primary-container)}.categorias-tabs[_ngcontent-%COMP%]     .mat-mdc-tab-group .mat-mdc-tab-header .mat-mdc-tab-label-container .mat-mdc-tab-list .mat-mdc-tab:hover:not(.mdc-tab--active){background:var(--mat-sys-surface-variant)}.categorias-tabs[_ngcontent-%COMP%]     .mat-mdc-tab-group .mat-mdc-tab-header .mat-mdc-tab-label-container .mat-mdc-tab-list .mat-mdc-tab .mdc-tab__text-label{font-size:.95rem;font-weight:500}.categorias-tabs[_ngcontent-%COMP%]     .mat-mdc-tab-group .mat-mdc-tab-header .mat-mdc-tab-header-pagination{display:none}.categorias-tabs[_ngcontent-%COMP%]     .mat-mdc-tab-group .mat-mdc-tab-body-wrapper .mat-mdc-tab-body .mat-mdc-tab-body-content{padding:0;overflow:visible}.tab-content[_ngcontent-%COMP%]{padding:24px;min-height:400px}.loading-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;padding:48px;color:var(--mat-sys-on-surface-variant)}.empty-state[_ngcontent-%COMP%]{text-align:center;padding:48px 24px;color:var(--mat-sys-on-surface-variant)}.empty-state[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:64px;width:64px;height:64px;margin-bottom:16px;opacity:.5}.empty-state[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 8px;font-size:1.25rem;font-weight:500}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0 0 24px;font-size:.95rem;line-height:1.4}@media (max-width: 768px){.categorias-container[_ngcontent-%COMP%]{padding:16px}.categorias-header[_ngcontent-%COMP%]{flex-direction:column;gap:16px;padding:20px;margin-bottom:24px}.categorias-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-size:1.75rem}.categorias-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .subtitle[_ngcontent-%COMP%]{font-size:.95rem}.categorias-header[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]{width:100%;justify-content:stretch}.categorias-header[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]   .add-button[_ngcontent-%COMP%]{flex:1;justify-content:center}.categorias-tabs[_ngcontent-%COMP%]     .mat-mdc-tab-group .mat-mdc-tab-header .mat-mdc-tab-label-container .mat-mdc-tab-list .mat-mdc-tab{min-width:80px;padding:0 12px;flex:1}.categorias-tabs[_ngcontent-%COMP%]     .mat-mdc-tab-group .mat-mdc-tab-header .mat-mdc-tab-label-container .mat-mdc-tab-list .mat-mdc-tab .mdc-tab__text-label{font-size:.875rem}.tab-content[_ngcontent-%COMP%]{padding:16px}}@media (max-width: 480px){.categorias-container[_ngcontent-%COMP%]{padding:12px}.categorias-header[_ngcontent-%COMP%]{padding:16px;margin-bottom:20px}.categorias-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-size:1.5rem}.categorias-tabs[_ngcontent-%COMP%]     .mat-mdc-tab-group .mat-mdc-tab-header .mat-mdc-tab-label-container .mat-mdc-tab-list .mat-mdc-tab{min-width:60px;padding:0 8px}.categorias-tabs[_ngcontent-%COMP%]     .mat-mdc-tab-group .mat-mdc-tab-header .mat-mdc-tab-label-container .mat-mdc-tab-list .mat-mdc-tab .mdc-tab__text-label{font-size:.8rem}.tab-content[_ngcontent-%COMP%]{padding:12px}}@media (prefers-contrast: high){.categorias-header[_ngcontent-%COMP%], .categorias-tabs[_ngcontent-%COMP%]{border:2px solid var(--mat-sys-outline)}.categorias-tabs[_ngcontent-%COMP%]     .mat-mdc-tab-group .mat-mdc-tab-header .mat-mdc-tab-label-container .mat-mdc-tab-list .mat-mdc-tab.mdc-tab--active{background:var(--mat-sys-primary);color:var(--mat-sys-on-primary)}}@media (prefers-reduced-motion: reduce){.categorias-container[_ngcontent-%COMP%], .prestamos-header[_ngcontent-%COMP%], app-categorias-stats[_ngcontent-%COMP%], .categorias-tabs[_ngcontent-%COMP%]{animation:none}.prestamos-header[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{transition:none}.prestamos-header[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{transform:none}.categorias-tabs[_ngcontent-%COMP%]     .mat-mdc-tab{transition:none}}@media print{.categorias-container[_ngcontent-%COMP%]{padding:0;background:var(--mat-sys-surface);color:var(--mat-sys-on-surface)}.categorias-header[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%], .categorias-tabs[_ngcontent-%COMP%]     .mat-mdc-tab-header{display:none}.categorias-tabs[_ngcontent-%COMP%]{box-shadow:none;border:1px solid var(--mat-sys-outline)}.tab-content[_ngcontent-%COMP%]{padding:16px}}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}@keyframes _ngcontent-%COMP%_slideInDown{0%{opacity:0;transform:translateY(-30px)}to{opacity:1;transform:translateY(0)}}@keyframes _ngcontent-%COMP%_slideInUp{0%{opacity:0;transform:translateY(30px)}to{opacity:1;transform:translateY(0)}}.prestamos-header[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{transition:all .3s ease}.prestamos-header[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:var(--mat-sys-elevation-level2)}.categorias-header[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]   .add-button[_ngcontent-%COMP%]:focus, .categorias-tabs[_ngcontent-%COMP%]     .mat-mdc-tab:focus{outline:2px solid var(--mat-sys-primary);outline-offset:2px}"]})};var He=[{path:"",component:X,data:{title:"Gesti\xF3n de Categor\xEDas",description:"Administra las categor\xEDas de gastos"}}],me=class r{static \u0275fac=function(e){return new(e||r)};static \u0275mod=dt({type:r});static \u0275inj=gt({providers:[I],imports:[bt,Dt,se.forChild(He),re]})};export{me as CategoriasModule};
